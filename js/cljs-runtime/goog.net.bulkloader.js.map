{
"version":3,
"file":"goog.net.bulkloader.js",
"lineCount":68,
"mappings":"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",
"sources":["goog/net/bulkloader.js"],
"sourcesContent":["// Copyright 2008 The Closure Library Authors. All Rights Reserved.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//      http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS-IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n/**\n * @fileoverview Loads a list of URIs in bulk. All requests must be a success\n * in order for the load to be considered a success.\n *\n */\n\ngoog.provide('goog.net.BulkLoader');\n\ngoog.require('goog.events.Event');\ngoog.require('goog.events.EventHandler');\ngoog.require('goog.events.EventTarget');\ngoog.require('goog.log');\ngoog.require('goog.net.BulkLoaderHelper');\ngoog.require('goog.net.EventType');\ngoog.require('goog.net.XhrIo');\n\n\n\n/**\n * Class used to load multiple URIs.\n * @param {Array<string|goog.Uri>} uris The URIs to load.\n * @constructor\n * @extends {goog.events.EventTarget}\n * @final\n */\ngoog.net.BulkLoader = function(uris) {\n  goog.events.EventTarget.call(this);\n\n  /**\n   * The bulk loader helper.\n   * @type {goog.net.BulkLoaderHelper}\n   * @private\n   */\n  this.helper_ = new goog.net.BulkLoaderHelper(uris);\n\n  /**\n   * The handler for managing events.\n   * @type {goog.events.EventHandler<!goog.net.BulkLoader>}\n   * @private\n   */\n  this.eventHandler_ = new goog.events.EventHandler(this);\n};\ngoog.inherits(goog.net.BulkLoader, goog.events.EventTarget);\n\n\n/**\n * A logger.\n * @type {goog.log.Logger}\n * @private\n */\ngoog.net.BulkLoader.prototype.logger_ =\n    goog.log.getLogger('goog.net.BulkLoader');\n\n\n/**\n * Gets the response texts, in order.\n * @return {Array<string>} The response texts.\n */\ngoog.net.BulkLoader.prototype.getResponseTexts = function() {\n  return this.helper_.getResponseTexts();\n};\n\n\n/**\n * Gets the request Uris.\n * @return {Array<string>} The request URIs, in order.\n */\ngoog.net.BulkLoader.prototype.getRequestUris = function() {\n  return this.helper_.getUris();\n};\n\n\n/**\n * Starts the process of loading the URIs.\n */\ngoog.net.BulkLoader.prototype.load = function() {\n  var eventHandler = this.eventHandler_;\n  var uris = this.helper_.getUris();\n  goog.log.info(\n      this.logger_, 'Starting load of code with ' + uris.length + ' uris.');\n\n  for (var i = 0; i < uris.length; i++) {\n    var xhrIo = new goog.net.XhrIo();\n    eventHandler.listen(\n        xhrIo, goog.net.EventType.COMPLETE,\n        goog.bind(this.handleEvent_, this, i));\n\n    xhrIo.send(uris[i]);\n  }\n};\n\n\n/**\n * Handles all events fired by the XhrManager.\n * @param {number} id The id of the request.\n * @param {goog.events.Event} e The event.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleEvent_ = function(id, e) {\n  goog.log.info(\n      this.logger_, 'Received event \"' + e.type + '\" for id ' + id +\n          ' with uri ' + this.helper_.getUri(id));\n  var xhrIo = /** @type {goog.net.XhrIo} */ (e.target);\n  if (xhrIo.isSuccess()) {\n    this.handleSuccess_(id, xhrIo);\n  } else {\n    this.handleError_(id, xhrIo);\n  }\n};\n\n\n/**\n * Handles when a request is successful (i.e., completed and response received).\n * Stores thhe responseText and checks if loading is complete.\n * @param {number} id The id of the request.\n * @param {goog.net.XhrIo} xhrIo The XhrIo objects that was used.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleSuccess_ = function(id, xhrIo) {\n  // Save the response text.\n  this.helper_.setResponseText(id, xhrIo.getResponseText());\n\n  // Check if all response texts have been received.\n  if (this.helper_.isLoadComplete()) {\n    this.finishLoad_();\n  }\n  xhrIo.dispose();\n};\n\n\n/**\n * Handles when a request has ended in error (i.e., all retries completed and\n * none were successful). Cancels loading of the URI's.\n * @param {number|string} id The id of the request.\n * @param {goog.net.XhrIo} xhrIo The XhrIo objects that was used.\n * @private\n */\ngoog.net.BulkLoader.prototype.handleError_ = function(id, xhrIo) {\n  // TODO(user): Abort all pending requests.\n\n  // Dispatch the ERROR event.\n  this.dispatchEvent(new goog.net.BulkLoader.LoadErrorEvent(xhrIo.getStatus()));\n  xhrIo.dispose();\n};\n\n\n/**\n * Finishes the load of the URI's. Dispatches the SUCCESS event.\n * @private\n */\ngoog.net.BulkLoader.prototype.finishLoad_ = function() {\n  goog.log.info(this.logger_, 'All uris loaded.');\n\n  // Dispatch the SUCCESS event.\n  this.dispatchEvent(goog.net.EventType.SUCCESS);\n};\n\n\n/** @override */\ngoog.net.BulkLoader.prototype.disposeInternal = function() {\n  goog.net.BulkLoader.superClass_.disposeInternal.call(this);\n\n  this.eventHandler_.dispose();\n  this.eventHandler_ = null;\n\n  this.helper_.dispose();\n  this.helper_ = null;\n};\n\n\n/**\n * @param {number} status The response status.\n * @constructor\n * @extends {goog.events.Event}\n * @final\n * @protected\n */\ngoog.net.BulkLoader.LoadErrorEvent = function(status) {\n  goog.net.BulkLoader.LoadErrorEvent.base(\n      this, 'constructor', goog.net.EventType.ERROR);\n\n  /** @type {number} */\n  this.status = status;\n};\ngoog.inherits(goog.net.BulkLoader.LoadErrorEvent, goog.events.Event);\n"],
"names":["goog","provide","require","net","BulkLoader","goog.net.BulkLoader","uris","events","EventTarget","call","helper_","BulkLoaderHelper","eventHandler_","EventHandler","inherits","prototype","logger_","log","getLogger","getResponseTexts","goog.net.BulkLoader.prototype.getResponseTexts","getRequestUris","goog.net.BulkLoader.prototype.getRequestUris","getUris","load","goog.net.BulkLoader.prototype.load","eventHandler","info","length","i","xhrIo","XhrIo","listen","EventType","COMPLETE","bind","handleEvent_","send","goog.net.BulkLoader.prototype.handleEvent_","id","e","type","getUri","target","isSuccess","handleSuccess_","handleError_","goog.net.BulkLoader.prototype.handleSuccess_","setResponseText","getResponseText","isLoadComplete","finishLoad_","dispose","goog.net.BulkLoader.prototype.handleError_","dispatchEvent","LoadErrorEvent","getStatus","goog.net.BulkLoader.prototype.finishLoad_","SUCCESS","disposeInternal","goog.net.BulkLoader.prototype.disposeInternal","superClass_","goog.net.BulkLoader.LoadErrorEvent","status","base","ERROR","Event"]
}
